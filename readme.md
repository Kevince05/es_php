TODO:finish sql injection protection